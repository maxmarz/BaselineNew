{% import "Ceres::Basket.Macros.AddToBasket" as AddToBasket %}

{% set itemData = config("Ceres.item.data") | split(', ') %}
{% set enabledRoutes = config("IO.routing.enabled_routes") | split(', ') %}
{% set shippingCat = config("Ceres.global.shippingCostsCategoryId") %}
{% set categoryBreadcrumbs = services.category.getHierarchy() %}

<script type="x/template" id="vue-single-item">
    <div>
        <div class="single container-max page-content">
            <div class="row m-t-2">
                <div class="col-md-6 single-leftside">
                    <div class="row">
                        <div class="col-xs-12">
                            <slot name="ImageCarousel"></slot>
                        </div>
                    </div>
                </div>

                <!-- ITEM DETAIL -->
                <div class="col-md-6 single-rightside m-t-1 p-l-2">

                    <h1 class="h2 title">
                        <span>
                            ${ currentVariation | itemName }
                        </span>
                    </h1>

                    <hr>

                    <div class="row p-l-1 articlenumber" data-plentyflow-modul="Artikelnummer">
                        <div data-plentyflow-element="title" class="col-md-4 col-xs-5">{{ trans("Ceres::Template.singleItemNumber") }}</div>
                        <div class="col-md-8 col-xs-7" itemprop="mpn">
                            <span data-plentyflow-element="text">${ currentVariation.variation.number }</span>
                        </div>
                    </div>

                    <div class="producertag row p-l-1" data-plentyflow-modul="Hersteller" v-if="currentVariation.filter.hasManufacturer">
                        <div data-plentyflow-element="title" class="col-md-4 col-xs-5">Hersteller</div>
                        <div class="col-md-8 col-xs-7" itemprop="brand">
                            <span class="producer text-muted" data-plentyflow-element="text">
                                 ${ currentVariation.item.manufacturer.externalName }
                            </span>
                        </div>
                    </div>

                    <div class="row p-l-1" data-plentyflow-modul="VerfÃ¼gbarkeit-{# item.documents[0].data.variation.availability.id #}">
                        <div data-plentyflow-element="title" class="col-md-4 col-xs-5">{{ trans("CeresBaseline::Template.itemAvailability") }}</div>
                        <meta itemprop="availability" itemtype="http://schema.org/InStock" content="In stock">
                        <div class="col-md-8 col-xs-7">
                            <span v-if="currentVariation.variation.availability" :class="'availability tag availability_' + currentVariation.variation.availability.id">
                                <span>
                                    ${ currentVariation.variation.availability.names.name }
                                </span>
                            </span>
                        </div>
                    </div>

                    <hr>
                    <!-- Variation -->
                    <div class="row m-b-1" v-if="variations.length > 0">
                        <variation-select template="#vue-variation-select" :attributes="attributeNameMap" :variation-units="variationUnits" :variations="variations" :preselect="currentVariation.variation.id" :unitPreselect="currentVariation.variation.unitCombinationId" @is-valid-change="isVariationSelected = $event"></variation-select>
                    </div>
                    <!-- /Variation -->

                    <!-- Item Bundle -->
                    <item-bundle :bundle-type="currentVariation.variation.bundleType" :bundle-components="currentVariation.bundleComponents"></item-bundle>
                    <!-- /Item Bundle -->

                    <slot name="BeforePrice"></slot>

                    <div class="row" v-if="currentVariation.filter.isSalable && variationGroupedProperties.length">
                        <order-property-list></order-property-list>
                    </div>

                    <graduated-prices template="#vue-graduated-prices"></graduated-prices>

                    {% if ('item.recommendedPrice' in itemData or 'all' in itemData) %}
                        <div class="crossprice" v-if="currentVariation.prices.rrp && currentVariation.prices.rrp.price.value > 0 && currentVariation.prices.rrp.price.value > currentVariation.prices.default.price.value">
                            <del class="text-muted small">
                                ${ currentVariation.prices.rrp.price.formatted }
                            </del>
                        </div>
                    {% endif %}

                    <span class="price h3">
                        <span ref="variationTotalPrice" :content="currentVariation.prices.default.price.value">
                            ${ variationTotalPrice | currency(currentVariation.prices.default.currency) }
                        </span>
                        <sup>*</sup>
                        <span :content="currentVariation.prices.default.currency"></span>
                    </span>

                    <div class="base-price text-muted m-y-1" v-if="currentVariation.unit">
                        <div>
                            {{ trans("Ceres::Template.singleItemContent") }}
                            <span>${ currentVariation.unit.content | numberFormat }</span>
                            <span>${ currentVariation.unit.names.name }</span>
                        </div>
                        <div v-if="currentVariation.variation.mayShowUnitPrice">
                            {{ trans("Ceres::Template.singleItemUnitPrice") }}
                            <span class="base-price-value">
                                ${ variationGraduatedPrice.basePrice }
                            </span>
                        </div>
                    </div>

                    <slot name="AfterPrice"></slot>

                    <span class="vat small text-muted">
                        * {% if services.customer.showNetPrices() %}{{ trans("Ceres::Template.singleItemExclVAT") }}{% else %}{{ trans("Ceres::Template.singleItemInclVAT") }}{% endif %} {{ trans("Ceres::Template.singleItemExclusive") }}
                        <a {% if shippingCat is not empty %} data-toggle="modal" href="#shippingscosts"{% endif %} title="{{ trans("Ceres::Template.singleItemShippingCosts") }}">{{ trans("Ceres::Template.singleItemShippingCosts") }}</a>
                    </span>

                    <slot name="AdditionalContentAfterVAT"></slot>


                    <div class="row m-y-1 addToBasket col-xs-12">
                        <slot name="BeforeAddToBasket"></slot>

                        {{ AddToBasket.printVueComponent(
                            "currentVariation",
                            false,
                            true,
                            {
                                ":missing-order-properties":"variationMissingProperties",
                                ":is-variation-selected": "isVariationSelected && currentVariation.filter.isSalable"
                            }
                        ) }}

                        <slot name="AfterAddToBasket"></slot>
                    </div>
                    <!-- ./ITEM DETAIL -->

                    <slot name="AdditionalContentAfterAddToBasket"></slot>

                </div>

                <!-- ITEM DESCRIPTION -->
                <script src="https://live.icecat.biz/js/live-current-2.js"></script>
                <div id="IcecatLive">
                </div>
                <script type="text/javascript">
                setTimeout(function(){IcecatLive.getDatasheet('#IcecatLive',{'UserName': 'openIcecat-live','Brand':'HP','ProductCode':'F0Y97EA'},'de');}, 200);
                </script>

            </div>
            <!-- ./ITEM DESCRIPTION -->

            <slot name="ItemListContainer"></slot>
            <slot name="FeedbackContainer"></slot>
        </div>
    </div>
</script>
